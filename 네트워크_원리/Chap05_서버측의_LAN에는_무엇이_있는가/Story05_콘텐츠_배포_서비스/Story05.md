# Story05 - 콘텐츠 배포 서비스
## 1. 콘텐츠 배포 서비스를 이용한 부하 분산
서버측에 캐시서버를 두면 단점
* 트래픽을 억제하는 효과는 없다.
* 따라서 클라이언트에 두는게 낫다.
* 큰 화상, 영상 같은 대용량 데이터를 포함하는 콘텐츠라면 효과가 큼

클라이언트측에 두는 캐시 서버
* 웹 서버 운영자가 제어할 수 없다.

캐시 서버는 놓는 장소에 따라 장단점 - 양측에 좋은 점을 취한 방법
* 웹 서버 운영자가 제어할 수 있는 캐시 서버를 클라이언트측의 프로바이더에 두는 방법
* 단점 : 인터넷의 어디에서 액세스하는지 알 수 없다.
  * 프로바이더의 POP 전부에 캐시 서버를 설치해야 함 - 너무 많다.

프로바이더에 중점
* 캐시 서버의 수를 줄일 수 있다.
* 웹 서버에 직접 액세스하는 여정을 단축시킬 수 있음

콘텐츠 배포 서비스
* 캐시 서버를 설치하고 웹 서버 운영자에게 대출하는 서비스

CDSP - 이 서비스를 제공하는 사업자
* 프로바이더와 계약하고 그곳에 다수의 캐시 서버를 설치
* 다수의 웹 서버 운영자가 공동으로 이용할 수도 있다.

## 2. 가장 가까운 캐시 서버의 관점
클라이언트 입장
* 가장 가까운 캐시 서버를 찾아내고 여기에 액세스하도록 중재하는 구조가 필요

복수 서버를 설치하여 부하를 분산시킬 때 DNS 서버에서 액세스를 분배하는 것과 비슷한 방법
* DNS서버가 클라이언트와 캐시 서버의 거리를 판단하여 가장 가까운 서버의 IP 주소를 회답하게 함
  1. 캐시 서버의 설치 장소에 있는 라우터에서 경로 정보를 모아둠
  2. 여러개의 라우터에서 경로표를 입수
  3. 이것을 사용하여 경로 정보를 조회
  4. 모든 라우터에 대해 조사하고 비교하여 어느 DNS 서버에 가장 가까운지 판단 가능

## 3. 리피터용 서버로 액세스 대상을 분배한다
리다이렉트(redirect)
* 다른 웹 서버에 액세스하도록 처리하는 것
* 이것을 사용하여 액세스 대상을 가장 가까운 캐시 서버로 돌리는 것

리다이렉트용 서버를 웹 서버측의 DNS 서버에 등록
* 여기로 클라이언트가 리퀘스트 메시지를 송신
* 가장 가까운 캐시 서버를 찾고
* 캐시 서버를 나타내는 Location 헤더를 붙여 응답을 돌려보내면
* 클라이언트는 캐시 서버에 다시 액세스

단점 
* 리다이렉트 HTTP 메시지가 증가
* 오버헤드가 많다

장점
* 정밀도가 높다
* 패킷의 왕복 시간을 통해 최적의 캐시 서버에 액세스하도록 내장한 페이지를 반송하는 방법도 있다.

## 4. 캐시 내용의 갱신 방법에서 성능의 차이가 난다
캐시 서버의 효율을 좌우하는 요소
* 캐시 내용을 갱신하는 방법

캐시 서버에서 확인하는 것 - 응답시간이 악화

웹 서버에서 처리
* 데이터가 갱신되면 즉시 캐시 서버에 반영
* 캐시 서버는 항상 최신의 상태를 유지할 수 있다.