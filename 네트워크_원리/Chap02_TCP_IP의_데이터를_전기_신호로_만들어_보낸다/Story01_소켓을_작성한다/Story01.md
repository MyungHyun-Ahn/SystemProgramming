# Story01 - 소켓을 작성한다.
## 1. 프로토콜 스택의 내부 구성

이번 장의 목표
* OS에 내장된 프로토콜 스택과 LAN 어댑터가 브라우저에서 받은 메시지를 서버에 송출하는 동작을 탐험


### 프로토콜 스택

프로토콜 스택
1. 애플리케이션
   * 네트워크 애플리케이션
   * Socket 라이브러리 - 리졸버
2. OS - 프로토콜 스택
   * TCP, UDP
   * IP - ICMP, ARP
3. 드라이버 소프트웨어
   * LAN 드라이버
4. 하드웨어
   * LAN 어댑터

특징
* 역할이 다른 몇 부분으로 나뉘어져 있다.
* 작업을 의뢰하는 쪽이 위쪽
* 의뢰를 받아 실제로 작업하는 쪽이 아래
* 상하 관계는 대략적인 경향
  * 확실하지는 않고 때에 따라 역전되는 경우도 있다.

네트워크 애플리케이션
* 웹 서버, 브라우저 등이 여기에 해당
* 여기부터 아래로 향하며 데이터 송수신의 일을 의뢰
* 어떤 애플리케이션이라도 네트워크에서 데이터를 송수신하는 동작은 거의 비슷

Socket 라이브러리
* 리졸버가 내장
  * DNS 서버에 조회하는 동작을 실행

OS의 내부 - 프로토콜 스택
* TCP와 UDP
  * 애플리케이션이 보낸 의뢰를 받아 송수신 동작 수행
* 일반적인 애플리케이션은 TCP
* DNS 서버에서의 조회 등 짧은 제어용 데이터를 송수신하면 UDP

IP 프로토콜
* 패킷을 통신 상대까지 운반
* ICMP의 ARP 
  * 패킷을 운반할 때 발생하는 오류를 통지하거나 제어용 메시지를 통지
  * MAC Address를 조사할 때 사용

LAN 드라이버
* LAN 어댑터의 하드웨어를 제어

LAN 어댑터
* 실제 송수신 동작, 케이블에 대해 신호를 송수신하는 동작을 실행

## 2. 소켓의 실체는 통신 제어용 제어 정보 

프로토콜 스택
* 내부에 제어 정보를 기록하는 메모리 영역을 가지고 있으며
* 여기에 통신 동작을 제어하기 위한 제어 정보를 기록
* 대표적으로 IP 주소, 포트 번호, 통신 동작이 어떤 진행 상태에 있는가 등

소켓 : 프로토콜 스택의 제어 정보
* 프로토콜 스택은 소켓에 기록된 제어 정보를 참조하며 동작

## 3. Socket을 호출했을 때의 동작
브라우저가 socket이나 connect 함수를 호출했을 때의 동작 과정

소켓을 만드는 과정 - socket
* 프로토콜 스택은 의뢰에 따라 소켓을 만듬
  1. 소켓 한 개 분량의 메모리 영역 확보
  2. 초기 상태의 제어 정보를 그곳에 기록
  3. 생성이 완료되면 디스크립터를 애플리케이션에 알려줌